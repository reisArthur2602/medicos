<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <title>Validação de Receita</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root { --bg:#f6f8fa; --card:#fff; --mut:#667085; --ok:#1a7f37; --bad:#b42318; --bd:#e5e7eb; }
    body { font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; background: var(--bg); margin: 0; padding: 24px; color:#111; }
    .box { background: var(--card); border-radius: 12px; max-width: 720px; margin: 0 auto; padding: 24px; box-shadow: 0 2px 8px rgba(16,24,40,.08); border:1px solid var(--bd); }
    h2 { margin: 0 0 12px; font-size: 22px; }
    .badge { display:inline-block; padding:4px 10px; border-radius:999px; font-size:13px; font-weight:600; }
    .ok  { background: #ecfdf3; color: var(--ok); border:1px solid #abefc6; }
    .bad { background: #fef3f2; color: var(--bad); border:1px solid #fecaca; }
    .row { margin: 8px 0; }
    .mut { color: var(--mut); }
    .texto { background:#fafafa; border:1px solid var(--bd); border-radius:10px; padding:12px; line-height:1.5; }
    .assin { margin-top: 16px; }
    img.assinatura { max-width: 220px; border:1px solid var(--bd); border-radius:8px; background:#fff; }
    .pdf { margin-top: 18px; }
    .pdf a { display:inline-block; margin-bottom:10px; }
    iframe { width: 100%; height: 420px; border:1px solid var(--bd); border-radius:10px; background:#fff; }
    .foot { margin-top: 18px; font-size:13px; color:#444; }
  </style>
</head>
<body>
  <div class="box">
    <h2>Validação de Receita</h2>

    <div class="row">
      {% if status == 1 %}
        <span class="badge ok">Documento VÁLIDO</span>
      {% else %}
        <span class="badge bad">Documento INVÁLIDO</span>
      {% endif %}
    </div>

    <div class="row">
      <strong>Médico:</strong> {{ nome_medico }} <span class="mut">|</span>
      <strong>Registro:</strong> {{ conselho_label }}
    </div>
    <div class="row">
      <strong>Paciente:</strong> {{ nome_paciente }} <span class="mut">|</span>
      <strong>CPF:</strong> {{ cpf_paciente }}
    </div>
    <div class="row">
      <strong>Emitido em:</strong> {{ data_emissao }}
    </div>

    <div class="row texto">
      {{ texto.replace('\n','<br>')|safe }}
    </div>

    <div class="assin">
      <strong>Assinatura do profissional:</strong><br>
      {% if assinatura_data_uri %}
        <img class="assinatura" src="{{ assinatura_data_uri }}" alt="Assinatura do profissional">
      {% else %}
        <span class="mut">Assinatura de carimbo não disponível</span>
      {% endif %}
    </div>

    <div class="pdf">
      <strong>PDF da receita:</strong><br>
      {% if pdf_filename %}
        <a href="{{ url_for('receita.servir_receita', nome_arquivo=pdf_filename) }}" target="_blank">Baixar PDF</a>
        <iframe src="{{ url_for('receita.servir_receita', nome_arquivo=pdf_filename) }}"></iframe>
      {% else %}
        <span class="mut">PDF não disponível</span>
      {% endif %}
    </div>

    <p class="foot">
      Assinatura digital verificada eletronicamente. Documento válido conforme MP 2.200-2/2001 (ICP-Brasil).
    </p>
  </div>
</body>
</html>
